%for a more compact document, add the option openany to avoid
%starting all chapters on odd numbered pages
\documentclass[12pt]{cmuthesis}

% This is a template for a CMU thesis.  It is 18 pages without any content :-)
% The source for this is pulled from a variety of sources and people.
% Here's a partial list of people who may or may have not contributed:
%
%        bnoble   = Brian Noble
%        caruana  = Rich Caruana
%        colohan  = Chris Colohan
%        comar    = Cyrus Omar
%        jab      = Justin Boyan
%        josullvn = Joseph O'Sullivan
%        jrs      = Jonathan Shewchuk
%        kosak    = Corey Kosak
%        mjz      = Matt Zekauskas (mattz@cs)
%        pdinda   = Peter Dinda
%        pfr      = Patrick Riley
%        dkoes = David Koes (me)

% My main contribution is putting everything into a single class files and small
% template since I prefer this to some complicated sprawling directory tree with
% makefiles.

% link formatting
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}


% some useful packages
\usepackage{times}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage[numbers,sort]{natbib}
\usepackage{subfigure}
\hypersetup{
pageanchor=true,plainpages=false,bookmarksnumbered,
pdfborder=0 0 0,  %removes outlines around hyper links in online display
}

% Approximately 1" margins, more space on binding side
\usepackage[letterpaper,twoside,vscale=.8,hscale=.75,nomarginpar]{geometry}
%for general printing (not binding)
% \usepackage[letterpaper,twoside,vscale=.8,hscale=.75,nomarginpar,hmarginratio=1:1]{geometry}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Nimo's macros

% latin: https://tex.stackexchange.com/questions/15009/macros-for-common-abbreviations
\usepackage{xspace}
\newcommand*{\eg}{e.g.,\@\xspace}
\newcommand*{\ie}{i.e.,\@\xspace}
\newcommand*{\apriori}{a priori\@\xspace}

\makeatletter
\newcommand*{\etc}{%
    \@ifnextchar{.}%
        {etc}%
        {etc.\@\xspace}%
}
% inline figures
\usepackage{wrapfig}

% remove blank pages
\let\cleardoublepage\clearpage

% systems
\newcommand*{\Penrose}{\textsc{Penrose}\xspace}
\newcommand*{\Substance}{\textsc{Substance}\xspace}
\newcommand*{\SubstanceColored}{\colorbox[HTML]{E7F3E7}{\Substance}\xspace}

\newcommand*{\Domain}{\textsc{Domain}\xspace}
\newcommand*{\Style}{\textsc{Style}\xspace}
\newcommand*{\Edgeworth}{\textsc{Edgeworth}\xspace}

% thesis statement
\newcommand{\boxtext}[1]{\begin{center} \fbox{ \parbox{0.95\linewidth}{ #1 }} \end{center} }

% fancy ref
\usepackage[capitalise, noabbrev]{cleveref}

% figure styling
\usepackage[font=footnotesize,labelfont=bf]{caption}

% quotes
\newcommand\quotei[1]{``\textit{#1}''}

% links
\renewcommand{\UrlFont}{\ttfamily\small}

% code
\usepackage{listings}
\usepackage{xcolor}
\usepackage{realboxes}
\definecolor{sub}{HTML}{E7F3E7}
\definecolor{sty}{HTML}{DDDEED}
\definecolor{dsl}{HTML}{DBDBDB}
\newcommand\sub[1]{\Colorbox{sub}{\lstinline{#1}}}
\newcommand\sty[1]{\Colorbox{sty}{\lstinline{#1}}}
\newcommand\dsl[1]{\Colorbox{dsl}{\lstinline{#1}}}
\usepackage{listings}
\newcommand{\lstbg}[3][0pt]{{\fboxsep#1\colorbox{#2}{\strut #3}}}
\lstdefinelanguage{JavaScript}{
  morekeywords=[1]{break, continue, delete, else, for, function, if, in, new, return, this, typeof, var, void, while, with, export, default class, class, extends, constructor, Circle},
  % Literals, primitive types, and reference types.
  morekeywords=[2]{false, null, true, boolean, number, undefined,
    Array, Boolean, Date, Math, Number, String, Object},
  % Built-ins.
  morekeywords=[3]{eval, parseInt, parseFloat, escape, unescape, matmul},
%   otherkeywords={=>, =},
  sensitive, 
  morecomment=[s]{/*}{*/},
  morecomment=[l]//,
  morecomment=[s]{/**}{*/}, % JavaDoc style comments
  morecomment=[f][\lstbg{red!20}]-,
  morecomment=[f][\lstbg{green!20}]+,
  morestring=[b]',
  morestring=[b]"
}[keywords, comments, strings]
\lstdefinestyle{CodeStyle}{
  language=JavaScript,
  tabsize=2,
  showspaces=false,
  showstringspaces=false
  breaklines=true,
  aboveskip = 0pt,
  belowskip = 0pt,
}
\lstset{    
  basicstyle=\linespread{0.8}\footnotesize\ttfamily, 
  style=CodeStyle,
  columns=fullflexible
} 

% algorithm
\usepackage{algorithm}
\usepackage{algpseudocode}

% margin mark
\usepackage[color, leftbars]{changebar}
\setlength\changebarsep{10pt}
\newenvironment{proposed}
    {
    \cbcolor[HTML]{FBB040}
    \setlength\changebarwidth{6pt}
    \cbstart
    }
    {
    \cbend 
    }

% timeline
\usepackage{pgfgantt}

% edgeworth design goals
\usepackage{enumitem}

% edgeworth ui labels
% figure annotation
\usetikzlibrary{calc}
\definecolor{labelColor}{RGB}{64,81,182}
\newcommand{\uilabel}[1]{\protect\tikz [font=\sffamily, baseline={($ (current bounding box.center) - (0,.3em) $)}] \fill[fill=labelColor] (0,0em) circle (0.6em) node[text=white] {#1};}

% algorithm position
\usepackage{float}

% table
\usepackage{array} % For m{} column specifier
\usepackage{colortbl}
\usepackage{multirow}

% full page figures
\usepackage{rotating}

% Define a command to create a progress bar
\definecolor{freqColor5}{HTML}{007000}
\definecolor{freqColor4}{HTML}{238823}
\definecolor{freqColor3}{HTML}{FFBF00}
\definecolor{freqColor2}{HTML}{FF6600}
\definecolor{freqColor1}{HTML}{D2222D}

\usetikzlibrary{calc}
\newcommand{\progressbar}[1]{%
    \begin{tikzpicture}[xscale=0.2, yscale=0.2, baseline=(current bounding box.south)]
        \draw[fill=white] (0, 0) rectangle (5, 1); % Background rectangle
        \ifdim #1pt<2pt
            \draw[fill=red] (0, 0) rectangle (#1, 1); % Red for <2
        \else\ifdim #1pt<3pt
            \draw[fill=freqColor2] (0, 0) rectangle (#1, 1); % Yellow for <3
        \else\ifdim #1pt<4pt
            \draw[fill=freqColor3] (0, 0) rectangle (#1, 1); % Yellow-green for <4
        \else
            \draw[fill=freqColor5] (0, 0) rectangle (#1, 1); % Green for >=4
        \fi\fi\fi
    \end{tikzpicture}%
}

% RQs
\newcounter{rqcounter} % Define a new counter for RQs
\renewcommand{\therqcounter}{RQ\arabic{rqcounter}} % Format the counter as RQ1, RQ2, etc.

\newcounter{rqsupcounter} % Define a new sub-counter for sub-RQs
\renewcommand{\therqsupcounter}{RQ3.\arabic{rqsupcounter}} % Format the sub-counter as RQ3.1, RQ3.2, etc.
% \renewcommand{\therqsupcounter}{RQ\arabic{rqsupcounter}} % Format the sub-counter as RQ1, 2, 3 etc

% Interviews chapter imports
\usepackage{subcaption}
\newcommand\itquote[1]{\hangindent=1em\hangafter=0
``\textit{#1}''}
\newcommand{\latin}[1]{{\it #1}}




% Penrose chapter imports
\usepackage{mdframed}
\usepackage{overpic}
\newcommand{\figloc}[1]{\textit{#1}}
\usepackage{listings, multicol} % code listings w/ formatting
\lstset{keepspaces=true}

\lstdefinelanguage{Sub-LA}{
  morekeywords={Vector, VectorSpace, Scalar, LinearMap, In, Orthogonal, EqualLength, Unit, Autolabel, Label, All, Default},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Sub-tensor}{
  morekeywords={Dim, Vector, Matrix, Scalar, Autolabel, Label, All, Default},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Sub-nn}{
  morekeywords={Dim, Vector, Matrix, Scalar, Function, vec, softmax, L, Autolabel, Label, All, Default},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Sub-mesh}{
  morekeywords={SimplicialComplex, Edge, Vertex, InVS, SimplicialSet, IsSubsetOf, Star, Subcomplex, SetMinus, Union, Closure, Link, Result, AutoLabel, Label, All, Default},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Sub-geom}{
  morekeywords={Table, Chair, BeerMug, Tavern, Plate, Point, Midpoint, Bisector, Triangle, Right, Obtuse, Acute, Angle, Line, Segment, Square, Rectangle, On, Parallel, PerpendicularBisector, Ray, Disjoint, Altitude, Endpoint, On, Perpendicular},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Sty-LA}{
  morekeywords={Vector, VectorSpace, Scalar, LinearMap, Arrow, Rectangle, Arc, Dot, AnchorPoint, CurlyBrace, Parallelogram, Line, global, forall, where, above, below, with, ensure, encourage, override, layer, ALL, CANVAS, delete},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Elem}{
  morekeywords={type, function, notation, predicate},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Sub-RA}{
  morekeywords={Reals, Real, Interval, Function, IsDifferentiable, IsDiscontinuous, Point, Autolabel, Pt, Label, NoLabel, All, Default},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Sub-SET}{
  morekeywords={Autolabel, Pt, Label, NoLabel, All, Default, Set, IsSubset, NotIntersecting},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Sty-RA}{
  morekeywords={Reals, Real, Interval, Function, Differentiable, Diff, Discontinuous, Point, Pt, LeftBounded, LeftClopen, Open, Bounded, Arrow, Rectangle, Arc, Dot, AnchorPoint, CurlyBrace, Parallelogram, Line, Tick, DoubleArrow, Bracket, Region, Curve, Paren, global, forall, where, above, below, with, ensure, encourage, override, layer, ALL, CANVAS, delete, Auto, optimized},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Sub-RT}{
  morekeywords={Scene, In, String, HasForm, PathSample, Sample, SceneSatisfies, AutoLabel, Diagram, LightSource, Camera, PathType, Path, VertexType, BounceType, DiffuseBounce, SpecularBounce, GlossyBounce, sample, Autolabel, Pt, Label, NoLabel, All, Default},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Sty-RT}{
  morekeywords={Diagram, LightSource, Camera, PathType, Path, VertexType, BounceType, DiffuseBounce, SpecularBounce, GlossyBounce, InList, Sublist, sample, PathVertex, Path, InVP, Hits, PathType, DiffuseObject, PathEdge, SpecularObject, Arrow, Rectangle, Arc, Dot, AnchorPoint, CurlyBrace, Parallelogram, Line, Tick, DoubleArrow, Bracket, Region, Curve, Paren, global, forall, where, above, below, with, ensure, encourage, override, layer, ALL, CANVAS, delete, Auto, optimized, plugin},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Sub-ST}{
  morekeywords={Set, Point, Map, Intersection, Union, Subtraction, CartesianProduct, Difference, Subset, AddPoint, Apply, From, Empty, Nonempty, Intersect, Nonintersecting, IsSubset, NotSubset, PointIn, PointNotIn, Injection, Not, Surjection, Bijection, Autolabel, Label, All, Default},
  morecomment=[l][\color{gray}]{--}
}

\lstdefinelanguage{Sty-ST}{
  morekeywords={Set, Point, Map, Intersection, Union, Subtraction, CartesianProduct, Difference, Subset, AddPoint, Apply, From, Empty, Nonempty, Intersect, Nonintersecting, IsSubset, NotSubset, PointIn, PointNotIn, Injection, Surjection, Bijection, global, forall, where, above, below, with, ensure, encourage, override, layer, ALL, CANVAS, delete},
  morecomment=[l][\color{gray}]{--}
}

\lstset{
  basicstyle=\small\ttfamily,
  columns=flexible,
  breaklines=true,
  mathescape=true,
  numbers=left
}

% mdframed style for Domain code
\definecolor{DslBGColor}{rgb}{0.95,0.95,0.95}
\definecolor{DslLineColor}{rgb}{0.85,0.85,0.85}
\mdfdefinestyle{DSLCode}{
    backgroundcolor=DslBGColor,
    linecolor=DslLineColor,
    linewidth=1pt,
    innertopmargin=8pt,
    innerbottommargin=8pt,
    innerleftmargin=8pt,
    innerrightmargin=8pt
 }

% mdframed style for Substance code
\definecolor{SubBGColor}{rgb}{0.92,0.97,0.92}
\definecolor{SubLineColor}{rgb}{0.87,0.92,0.87}
\mdfdefinestyle{SUBCode}{
    backgroundcolor=SubBGColor,
    linecolor=SubLineColor,
    linewidth=1pt,
    innertopmargin=8pt,
    innerbottommargin=8pt,
    innerleftmargin=8pt,
    innerrightmargin=8pt
 }

% mdframed style for Style code
\definecolor{StyBGColor}{rgb}{0.95,0.95,1.00}
\definecolor{StyLineColor}{rgb}{0.9,0.9,0.95}
\mdfdefinestyle{STYCode}{
    backgroundcolor=StyBGColor,
    linecolor=StyLineColor,
    linewidth=1pt,
    innertopmargin=8pt,
    innerbottommargin=8pt,
    innerleftmargin=8pt,
    innerrightmargin=8pt
 }

\usepackage{tikz}
\newcommand\inlineDSL[2][]{\ \tikz[overlay]\node[draw,inner sep=2pt, anchor=text, rectangle, thick, color=DslLineColor, fill=DslBGColor, text=black,] {#2};\phantom{#2}\ }
\newcommand\inlineSUB[2][]{\ \tikz[overlay]\node[draw,inner sep=2pt, anchor=text, rectangle, thick, color=SubLineColor, fill=SubBGColor, text=black,] {#2};\phantom{#2}\ }
\newcommand\inlineSTY[2][]{\ \tikz[overlay]\node[draw,inner sep=2pt, anchor=text, rectangle, thick, color=StyLineColor, fill=StyBGColor, text=black,] {#2};\phantom{#2}\ }

\newcommand{\keyword}[1]{\texttt{\textbf{#1}}}
\usepackage{amssymb}
\usepackage{upgreek}
\newcommand{\resp}{\emph{resp.}} % "respectively"
\def\ContinueLineNumber{\lstset{firstnumber=last}}

% typewriter font
\usepackage{inconsolata} % Load the Inconsolata font
\renewcommand{\ttdefault}{zi4} % Set Inconsolata as the default typewriter font


% Goals
\newcounter{goalcounter} % Define a new counter for RQs
\renewcommand{\thegoalcounter}{Goal \arabic{goalcounter}} % Format the counter as RQ1, RQ2, etc.

% \usepackage{caption}
% \captionsetup[table] % Adjusts space between the table caption and the table


% chinese
% \usepackage{xeCJK}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Provides a draft mark at the top of the document. 
\draftstamp{\today}{DRAFT}

% 


\begin {document} 
\frontmatter

%initialize page style, so contents come out right (see bot) -mjz
\pagestyle{empty}

\title{ 
{\bf Developing conceptual understanding through interactive diagramming}}

\author{Wode ``Nimo'' Ni}
\date{\today}
\Year{2024}
\trnumber{CMU-S3D-24-XXX}

\committee{
Kenneth Koedinger and Joshua Sunshine, Carnegie Mellon University, Co-chairs \\
Brad Myers, Carnegie Mellon University \\
Titus Barik, Apple\\
Shriram Krishnamurthi, Brown University\\
\trnumber{}
}

% \support{}
% \disclaimer{}

% copyright notice generated automatically from Year and author.
% permission added if \permission{} given.

% \keywords{Stuff, More Stuff}

\maketitle

\begin{dedication}
To the pool gods.
\end{dedication}

\pagestyle{plain} % for toc, was empty

\begin{abstract}

TODO
% ``Mental pictures'' and ``visual intuition'' capture how people make sense of abstract concepts and see solutions to hard problems in a visual way. Learning research suggests that visual representations of knowledge are powerful tools for thought. Visual representations like diagrams enable more robust learning and flexible problem solving. 

% Existing diagramming tools often require hours of low-level tweaking of geometric primitives and do not capture the core task of diagramming: representing ideas visually. \Penrose is a diagramming platform that explicitly encodes visual representations in domain-specific languages. In this thesis proposal, I argue that this explicit encoding can be leveraged to (1) reduce the programming effort of producing diagrammatic problems at scale and (2) simplify the workflow of authoring interactive diagrams. The resulting diagrams also carry rich semantics, and I'll discuss how to use them to (3) provide useful, automated feedback to students. 


\end{abstract}

\begin{acknowledgments}
TODO
\end{acknowledgments}


\tableofcontents
% \listoffigures
% \listoftables

\mainmatter

%% Double space document for easy review:
%\renewcommand{\baselinestretch}{1.66}\normalsize

% The other requirements Catherine has:
%
%  - avoid large margins.  She wants the thesis to use fewer pages, 
%    especially if it requires colour printing.
%
%  - The thesis should be formatted for double-sided printing.  This
%    means that all chapters, acknowledgements, table of contents, etc.
%    should start on odd numbered (right facing) pages.
%
%  - You need to use the department standard tech report title page.  I
%    have tried to ensure that the title page here conforms to this
%    standard.
%
%  - Use a nice serif font, such as Times Roman.  Sans serif looks bad.
%
% Other than that, just make it look good...


% \input{prelude}
\chapter{Introduction}
\input{introduction}

\chapter{Background and Related Work}
\label{chp:background}

\chapter[Understanding the Diagramming Process]{Understanding the Diagramming Process\footnote{This chapter is adapted from \textit{How Domain Experts Create Conceptual Diagrams and Implications for Tool Design}~\cite{naturalDiagramming}.}}
\label{chp:interviews}
\input{interviews}

\chapter[\Penrose: From Notations to Beautiful Diagrams]{\Penrose: From Notations to Beautiful Diagrams\footnote{
This chapter is adapted from \textit{\Penrose: From Mathematical Notation to Beautiful Diagrams} \cite{penrose}
}}
\label{chp:penrose}
\input{penrose}

\chapter[\Edgeworth: Diagrammatic Problem Authoring at Scale]{\Edgeworth: Diagrammatic Problem Authoring at Scale\footnote{This chapter is adapted from Sections 1 to 5 of \textit{\Edgeworth: Efficient and Scalable Authoring of Visual Thinking Activities} \cite{ni_edgeworth_2024}}}
\label{chp:edgeworth}
\input{edgeworth}

\chapter[Evaluating \Edgeworth{}]{Evaluating \Edgeworth{}\footnote{This chapter is partly adapted from \citet[Sections~6--7]{ni_edgeworth_2024}.}}
\label{chp:edgeworth-eval}
\input{edgeworth-eval}

\chapter{Conclusion and Future Work}
\label{chp:conclusion}
% \input{conclusion}

% \appendix
% \include{appendix}

\backmatter

\renewcommand{\baselinestretch}{1.0}\normalsize

% By default \bibsection is \chapter*, but we really want this to show
% up in the table of contents and pdf bookmarks.
\renewcommand{\bibsection}{\chapter{\bibname}}
%\renewcommand{\bibpreamble}{This text goes between the ``Bibliography''
%  header and the actual list of references}
\bibliographystyle{thesis-style}
\bibliography{zotero} %your bib file

\end{document}
