%for a more compact document, add the option openany to avoid
%starting all chapters on odd numbered pages
\documentclass[12pt]{cmuthesis}

% This is a template for a CMU thesis.  It is 18 pages without any content :-)
% The source for this is pulled from a variety of sources and people.
% Here's a partial list of people who may or may have not contributed:
%
%        bnoble   = Brian Noble
%        caruana  = Rich Caruana
%        colohan  = Chris Colohan
%        comar    = Cyrus Omar
%        jab      = Justin Boyan
%        josullvn = Joseph O'Sullivan
%        jrs      = Jonathan Shewchuk
%        kosak    = Corey Kosak
%        mjz      = Matt Zekauskas (mattz@cs)
%        pdinda   = Peter Dinda
%        pfr      = Patrick Riley
%        dkoes = David Koes (me)

% My main contribution is putting everything into a single class files and small
% template since I prefer this to some complicated sprawling directory tree with
% makefiles.

% link formatting
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}


% some useful packages
\usepackage{times}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage[numbers,sort]{natbib}
\usepackage{subfigure}
\hypersetup{
pageanchor=true,plainpages=false,bookmarksnumbered,
pdfborder=0 0 0,  %removes outlines around hyper links in online display
}

% Approximately 1" margins, more space on binding side
%\usepackage[letterpaper,twoside,vscale=.8,hscale=.75,nomarginpar]{geometry}
%for general printing (not binding)
\usepackage[letterpaper,twoside,vscale=.8,hscale=.75,nomarginpar,hmarginratio=1:1]{geometry}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Nimo's macros

% latin: https://tex.stackexchange.com/questions/15009/macros-for-common-abbreviations

\usepackage{xspace}
\newcommand*{\eg}{e.g.\@\xspace}
\newcommand*{\ie}{i.e.\@\xspace}
\newcommand*{\apriori}{a priori\@\xspace}

\makeatletter
\newcommand*{\etc}{%
    \@ifnextchar{.}%
        {etc}%
        {etc.\@\xspace}%
}
% inline figures
\usepackage{wrapfig}

% remove blank pages
\let\cleardoublepage\clearpage

% systems
\newcommand*{\Penrose}{\textsc{Penrose}\xspace}
\newcommand*{\Substance}{\textsc{Substance}\xspace}
\newcommand*{\Domain}{\textsc{Domain}\xspace}
\newcommand*{\Style}{\textsc{Style}\xspace}
\newcommand*{\Edgeworth}{\textsc{Edgeworth}\xspace}

% thesis statement
\newcommand{\boxtext}[1]{\begin{center} \fbox{ \parbox{0.95\linewidth}{ #1 }} \end{center} }

% fancy ref
\usepackage[capitalise, noabbrev]{cleveref}

% figure styling
\usepackage[font=footnotesize,labelfont=bf]{caption}

% quotes
\newcommand\quotei[1]{``\textit{#1}''}

% links
\renewcommand{\UrlFont}{\ttfamily\small}

% code
\usepackage{listings}
\usepackage{xcolor}
\usepackage{realboxes}
\definecolor{sub}{HTML}{E7F3E7}
\definecolor{sty}{HTML}{DDDEED}
\definecolor{dsl}{HTML}{DBDBDB}
\newcommand\sub[1]{\Colorbox{sub}{\lstinline{#1}}}
\newcommand\sty[1]{\Colorbox{sty}{\lstinline{#1}}}
\newcommand\dsl[1]{\Colorbox{dsl}{\lstinline{#1}}}
\usepackage{listings}
\newcommand{\lstbg}[3][0pt]{{\fboxsep#1\colorbox{#2}{\strut #3}}}
\lstdefinelanguage{JavaScript}{
  morekeywords=[1]{break, continue, delete, else, for, function, if, in, new, return, this, typeof, var, void, while, with, export, default class, class, extends, constructor, Circle},
  % Literals, primitive types, and reference types.
  morekeywords=[2]{false, null, true, boolean, number, undefined,
    Array, Boolean, Date, Math, Number, String, Object},
  % Built-ins.
  morekeywords=[3]{eval, parseInt, parseFloat, escape, unescape, matmul},
%   otherkeywords={=>, =},
  sensitive, 
  morecomment=[s]{/*}{*/},
  morecomment=[l]//,
  morecomment=[s]{/**}{*/}, % JavaDoc style comments
  morecomment=[f][\lstbg{red!20}]-,
  morecomment=[f][\lstbg{green!20}]+,
  morestring=[b]',
  morestring=[b]"
}[keywords, comments, strings]
\lstdefinestyle{CodeStyle}{
  language=JavaScript,
  tabsize=2,
  showspaces=false,
  showstringspaces=false
  breaklines=true,
  aboveskip = 0pt,
  belowskip = 0pt,
}
\lstset{    
  basicstyle=\linespread{0.8}\footnotesize\ttfamily, 
  style=CodeStyle,
  columns=fullflexible
} 

% algorithm
\usepackage{algorithm}
\usepackage{algpseudocode}

% margin mark
\usepackage[color, leftbars]{changebar}
\setlength\changebarsep{10pt}
\newenvironment{proposed}
    {
    \cbcolor[HTML]{FBB040}
    \setlength\changebarwidth{6pt}
    \cbstart
    }
    {
    \cbend 
    }

% timeline
\usepackage{pgfgantt}

% edgeworth design goals
\usepackage{enumitem}

% edgeworth ui labels
% figure annotation
\usetikzlibrary{calc}
\definecolor{labelColor}{RGB}{64,81,182}
\newcommand{\uilabel}[1]{\protect\tikz [font=\sffamily, baseline={($ (current bounding box.center) - (0,.3em) $)}] \fill[fill=labelColor] (0,0em) circle (0.6em) node[text=white] {#1};}

% algorithm position
\usepackage{float}

% table
\usepackage{array} % For m{} column specifier
\usepackage{colortbl}
\usepackage{multirow}

% full page figures
\usepackage{rotating}

% Define a command to create a progress bar
\definecolor{freqColor5}{HTML}{007000}
\definecolor{freqColor4}{HTML}{238823}
\definecolor{freqColor3}{HTML}{FFBF00}
\definecolor{freqColor2}{HTML}{FF6600}
\definecolor{freqColor1}{HTML}{D2222D}

\usetikzlibrary{calc}
\newcommand{\progressbar}[1]{%
    \begin{tikzpicture}[xscale=0.2, yscale=0.2, baseline=(current bounding box.south)]
        \draw[fill=white] (0, 0) rectangle (5, 1); % Background rectangle
        \ifdim #1pt<2pt
            \draw[fill=red] (0, 0) rectangle (#1, 1); % Red for <2
        \else\ifdim #1pt<3pt
            \draw[fill=freqColor2] (0, 0) rectangle (#1, 1); % Yellow for <3
        \else\ifdim #1pt<4pt
            \draw[fill=freqColor3] (0, 0) rectangle (#1, 1); % Yellow-green for <4
        \else
            \draw[fill=freqColor5] (0, 0) rectangle (#1, 1); % Green for >=4
        \fi\fi\fi
    \end{tikzpicture}%
}
% \newcommand{\progressbar}[1]{%
% \begin{tikzpicture}[xscale=0.04,yscale=0.1,baseline=(current bounding box.south)]
%   \draw[fill=white] (0,0) rectangle (10, 1.5);
% %   \draw[fill=black!30!black] (0,0) rectangle ($(#1/10, 1.5)$);
% \ifnum#1<4
%   % \draw[fill=green] (0,0) rectangle ($(#1*2/10, 1.5)$);
%   \draw[fill=green] (0,0) rectangle ($(10, 1.5)$);
%   \else
%   \draw[fill=black] (0,0) rectangle ($(#1*2/10, 1.5)$);
% \fi
% \end{tikzpicture}
% }

% \usepackage{caption}
% \captionsetup[table] % Adjusts space between the table caption and the table


% chinese
% \usepackage{xeCJK}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Provides a draft mark at the top of the document. 
\draftstamp{\today}{DRAFT}

% 


\begin {document} 
\frontmatter

%initialize page style, so contents come out right (see bot) -mjz
\pagestyle{empty}

\title{ 
{\bf Developing conceptual understanding through interactive diagramming}}

\author{Wode ``Nimo'' Ni}
\date{\today}
\Year{2024}
\trnumber{CMU-S3D-24-XXX}

\committee{
Kenneth Koedinger and Joshua Sunshine, Carnegie Mellon University, Co-chairs \\
Brad Myers, Carnegie Mellon University \\
Titus Barik, Apple\\
Shriram Krishnamurthi, Brown University\\
\trnumber{}
}

% \support{}
% \disclaimer{}

% copyright notice generated automatically from Year and author.
% permission added if \permission{} given.

\keywords{Stuff, More Stuff}

\maketitle

\begin{dedication}
TODO
\end{dedication}

\pagestyle{plain} % for toc, was empty

%% Obviously, it's probably a good idea to break the various sections of your thesis
%% into different files and input them into this file...

\begin{abstract}
``Mental pictures'' and ``visual intuition'' capture how people make sense of abstract concepts and see solutions to hard problems in a visual way. Learning research suggests that visual representations of knowledge are powerful tools for thought. Visual representations like diagrams enable more robust learning and flexible problem solving. 

Existing diagramming tools often require hours of low-level tweaking of geometric primitives and do not capture the core task of diagramming: representing ideas visually. \Penrose is a diagramming platform that explicitly encodes visual representations in domain-specific languages. In this thesis proposal, I argue that this explicit encoding can be leveraged to (1) reduce the programming effort of producing diagrammatic problems at scale and (2) simplify the workflow of authoring interactive diagrams. The resulting diagrams also carry rich semantics, and I'll discuss how to use them to (3) provide useful, automated feedback to students. 


\end{abstract}

\begin{acknowledgments}
TODO
\end{acknowledgments}


\tableofcontents
\listoffigures
\listoftables

\mainmatter

%% Double space document for easy review:
%\renewcommand{\baselinestretch}{1.66}\normalsize

% The other requirements Catherine has:
%
%  - avoid large margins.  She wants the thesis to use fewer pages, 
%    especially if it requires colour printing.
%
%  - The thesis should be formatted for double-sided printing.  This
%    means that all chapters, acknowledgements, table of contents, etc.
%    should start on odd numbered (right facing) pages.
%
%  - You need to use the department standard tech report title page.  I
%    have tried to ensure that the title page here conforms to this
%    standard.
%
%  - Use a nice serif font, such as Times Roman.  Sans serif looks bad.
%
% Other than that, just make it look good...


% \input{prelude}
\chapter{Introduction}
% \input{introduction}

\chapter{Understanding the diagramming process and encoding visual representations}
\label{chp:interviews}
% \input{interviews}

\chapter{\Penrose: from notations to beautiful diagrams}
\label{chp:penrose}
% \input{penrose}

\chapter[\Edgeworth: diagrammatic problem authoring at scale]{\Edgeworth: diagrammatic problem authoring at scale\footnote{This chapter is adapted from \citet[Sections~1--5]{ni_edgeworth_2024}}}
\label{chp:edgeworth}
\input{edgeworth}

\chapter{Evaluating \Edgeworth{}}
\label{chp:edgeworth-eval}
\input{edgeworth-eval}

\chapter{Conclusion and Future Work}
\label{chp:conclusion}
% \input{conclusion}

% I will compare the time it takes participants to create content and the quality of the content. 
% I will recruit previous formative participants for this study and draw from the formative participant pool if needed.


% \appendix
% \include{appendix}

\backmatter

\renewcommand{\baselinestretch}{1.0}\normalsize

% By default \bibsection is \chapter*, but we really want this to show
% up in the table of contents and pdf bookmarks.
% \renewcommand{\bibsection}{\chapter{\bibname}}
%\renewcommand{\bibpreamble}{This text goes between the ``Bibliography''
%  header and the actual list of references}
\bibliographystyle{thesis-style}
\bibliography{references,zotero} %your bib file

\end{document}
